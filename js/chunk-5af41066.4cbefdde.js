(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5af41066"],{8418:function(t,s,a){"use strict";var e=a("c04e"),r=a("9bf2"),i=a("5c6c");t.exports=function(t,s,a){var o=e(s);o in t?r.f(t,o,i(0,a)):t[o]=a}},"99af":function(t,s,a){"use strict";var e=a("23e7"),r=a("d039"),i=a("e8b5"),o=a("861d"),c=a("7b0b"),n=a("50c4"),l=a("8418"),u=a("65f0"),d=a("1dde"),f=a("b622"),m=a("2d00"),p=f("isConcatSpreadable"),v=9007199254740991,h="Maximum allowed index exceeded",C=m>=51||!r((function(){var t=[];return t[p]=!1,t.concat()[0]!==t})),g=d("concat"),_=function(t){if(!o(t))return!1;var s=t[p];return void 0!==s?!!s:i(t)},b=!C||!g;e({target:"Array",proto:!0,forced:b},{concat:function(t){var s,a,e,r,i,o=c(this),d=u(o,0),f=0;for(s=-1,e=arguments.length;s<e;s++)if(i=-1===s?o:arguments[s],_(i)){if(r=n(i.length),f+r>v)throw TypeError(h);for(a=0;a<r;a++,f++)a in i&&l(d,f,i[a])}else{if(f>=v)throw TypeError(h);l(d,f++,i)}return d.length=f,d}})},c099:function(t,s,a){"use strict";a("cb89")},c95d:function(t,s,a){"use strict";a.r(s);var e=function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",[a("section",{staticClass:"container  my-5"},[a("div",{staticClass:"h2 text-secondary text-center"},[t._v("上田園農產 結帳流程")]),t._m(0),a("div",{staticClass:"row justify-content-center mt-3"},[a("div",{staticClass:"col-8 "},[a("div",{staticClass:"card mb-3"},[a("div",{staticClass:"card-header",attrs:{id:"cartDetail"}},[a("div",{staticClass:"d-flex justify-content-around align-items-center"},[a("a",{staticClass:"btn btn-link btn-block text-left",attrs:{href:"#",type:"button","data-toggle":"collapse","data-target":"#collapseCart"}},[t._v(" 購物車明細 ")]),a("strong",[t._v(t._s(t._f("currency")(t.carts.total+80)))])])])]),a("div",{staticClass:"collapse show",attrs:{id:"collapseCart","data-parent":"#cartDetail"}},[a("div",{staticClass:"table-responsive my-3"},[a("table",{staticClass:"table"},[t._l(t.carts.carts,(function(s){return a("tr",{key:s.id},[a("td",[a("a",{staticClass:"far fa-trash-alt text-danger",attrs:{href:"#"},on:{click:function(a){return a.preventDefault(),t.showAlert(s.id)}}})]),a("td",[t._v(t._s(s.product.title))]),a("td",[a("img",{staticClass:"cart-img",attrs:{src:s.product.imageUrl,alt:"商品圖"}})]),a("td",[t._v(t._s(s.qty))]),a("td",[t._v(t._s(s.product.unit))]),a("td",{staticClass:"text-right"},[t._v("NT$"+t._s(s.total))])])})),a("tr",[a("td",{staticClass:"text-right",attrs:{colspan:"5"}},[t._v("運費")]),a("td",{staticClass:"text-right"},[t._v(t._s(t._f("currency")(80)))])]),a("tr",[a("td",{staticClass:"text-right",attrs:{colspan:"5"}},[t._v("總計")]),a("td",{staticClass:"text-right"},[t._v(t._s(t._f("currency")(t.carts.total+80)))])]),a("tr",[t.carts.total!==t.carts.final_total?a("td",{staticClass:"text-right text-success",attrs:{colspan:"5"}},[t._v("折扣價")]):t._e(),t.carts.total!==t.carts.final_total?a("td",{staticClass:"text-right text-success"},[t._v(" "+t._s(t._f("currency")(t.carts.final_total+80))+" ")]):t._e()])],2),a("div",{staticClass:"text-right text-success mb-2 "},[t._v(" "+t._s(t.couponMsg)+" ")]),a("div",{staticClass:"input-group"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.couponCode,expression:"couponCode"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.couponCode},on:{input:function(s){s.target.composing||(t.couponCode=s.target.value)}}}),a("div",{staticClass:"input-group-append"},[a("a",{staticClass:"btn btn-outline-success",attrs:{href:"#"},on:{click:function(s){return s.preventDefault(),t.useCoupon(s)}}},[t._v("套用優惠券")])])])])]),a("div",{staticClass:"h3 bg-light text-center text-secondary py-3"},[t._v("訂購人資訊")]),a("validation-observer",{scopedSlots:t._u([{key:"default",fn:function(s){var e=s.invalid;return[a("form",{on:{submit:function(s){return s.preventDefault(),t.sendOrder(s)}}},[a("div",{staticClass:"form-row"},[a("div",{staticClass:"form-group col-md-6"},[a("validation-provider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(s){var e=s.errors,r=s.classes;return[a("label",{attrs:{for:"name"}},[t._v("訂購人姓名 "),a("span",{staticClass:"text-danger"},[t._v("*")])]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user.name,expression:"form.user.name"}],staticClass:"form-control",class:r,attrs:{type:"text",name:"姓名",id:"name",placeholder:"請輸入姓名"},domProps:{value:t.form.user.name},on:{input:function(s){s.target.composing||t.$set(t.form.user,"name",s.target.value)}}}),a("span",{staticClass:"invalid-feedback"},[t._v(t._s(e[0]))])]}}],null,!0)})],1),a("div",{staticClass:"form-group col-md-6"},[a("validation-provider",{attrs:{rules:"required|email"},scopedSlots:t._u([{key:"default",fn:function(s){var e=s.errors,r=s.classes;return[a("label",{attrs:{for:"email"}},[t._v("訂購人Email "),a("span",{staticClass:"text-danger"},[t._v("*")])]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user.email,expression:"form.user.email"}],staticClass:"form-control",class:r,attrs:{type:"text",name:"email",id:"email",placeholder:"請輸入email"},domProps:{value:t.form.user.email},on:{input:function(s){s.target.composing||t.$set(t.form.user,"email",s.target.value)}}}),a("span",{staticClass:"invalid-feedback"},[t._v(t._s(e[0]))])]}}],null,!0)})],1)]),a("div",{staticClass:"form-row"},[a("validation-provider",{staticClass:"form-group col-md-6",attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(s){var e=s.errors,r=s.classes;return[a("div",[a("label",{attrs:{for:"tel"}},[t._v("連絡電話 "),a("span",{staticClass:"text-danger"},[t._v("*")])]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user.tel,expression:"form.user.tel"}],staticClass:"form-control",class:r,attrs:{type:"tel",name:"電話",id:"tel"},domProps:{value:t.form.user.tel},on:{input:function(s){s.target.composing||t.$set(t.form.user,"tel",s.target.value)}}}),a("span",{staticClass:"invalid-feedback"},[t._v(t._s(e[0]))])])]}}],null,!0)}),a("div",{staticClass:"form-group col-md-6"},[a("label",{staticClass:"mr-3",attrs:{for:"shipping"}},[t._v(" 取貨方式 : ")]),a("div",{staticClass:"form-check"},[a("input",{staticClass:"form-check-input",attrs:{type:"radio",id:"selfTake",name:"shippingOption",checked:""}}),a("label",{staticClass:"form-check-label",attrs:{for:"selfTake"}},[t._v("到店自取")])]),a("div",{staticClass:"form-check"},[a("input",{staticClass:"form-check-input",attrs:{type:"radio",id:"shipping",name:"shippingOption"}}),a("label",{staticClass:"form-check-label",attrs:{for:"shipping"}},[t._v("宅配寄送")])])])],1),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"address"}},[t._v("寄送地址 "),a("small",{staticClass:"ml-2"},[t._v("若自取可跳過此欄位")])]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user.address,expression:"form.user.address"}],staticClass:"form-control",attrs:{type:"text",name:"address",id:"address",placeholder:"路名、樓層等等"},domProps:{value:t.form.user.address},on:{input:function(s){s.target.composing||t.$set(t.form.user,"address",s.target.value)}}})]),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"message"}},[t._v("留言")]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.message,expression:"form.message"}],staticClass:"form-control",attrs:{name:"留言區",id:"message",cols:"20",rows:"5",placeholder:"有什麼特殊需求嗎?"},domProps:{value:t.form.message},on:{input:function(s){s.target.composing||t.$set(t.form,"message",s.target.value)}}})]),a("div",{staticClass:"d-flex justify-content-end"},[a("router-link",{staticClass:"btn btn-secondary mr-1",attrs:{to:{name:"Shopping"}}},[t._v("繼續逛逛")]),a("button",{staticClass:"btn btn-primary",attrs:{type:"submit",disabled:e}},[t._v("下一步")])],1)])]}}])})],1)])])])},r=[function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"row mt-3"},[a("div",{staticClass:"col-lg-4"},[a("div",{staticClass:"alert alert-primary d-flex flex-column align-items-center alert-rounded"},[a("small",[t._v("STEP 1.")]),a("i",{staticClass:"fas fa-info mb-1"}),a("p",{staticClass:"h5"},[t._v("輸入訂購人資料")])])]),a("div",{staticClass:"col-lg-4"},[a("div",{staticClass:"alert alert-light d-flex flex-column align-items-center alert-rounded"},[a("small",[t._v("STEP 2.")]),a("i",{staticClass:"fas fa-clipboard-list  mb-1"}),a("p",{staticClass:"h5"},[t._v("確認訂單&選擇付款方式")])])]),a("div",{staticClass:"col-lg-4"},[a("div",{staticClass:"alert alert-light d-flex flex-column align-items-center alert-rounded"},[a("small",[t._v("STEP 3.")]),a("i",{staticClass:"fas fa-check-circle mb-1"}),a("p",{staticClass:"h5"},[t._v("完成購買")])])])])}],i=(a("99af"),a("e68f")),o={name:"CheckOut",data:function(){return{couponCode:"",couponMsg:"",form:{user:{address:""},message:""}}},mixins:[i["a"]],methods:{useCoupon:function(){var t="".concat("https://vue-course-api.hexschool.io","/api/").concat("hsinhui","/coupon"),s=this,a={code:s.couponCode};this.$http.post(t,{data:a}).then((function(t){s.couponCode="",t.data.success?(s.couponMsg=t.data.message,s.getCartList()):s.$swal("找不到此優惠券")})).catch((function(t){s.$swal("找不到此優惠券")}))},sendOrder:function(){var t="".concat("https://vue-course-api.hexschool.io","/api/").concat("hsinhui","/order"),s=this;this.$http.post(t,{data:s.form}).then((function(t){if(t.data.success){console.log(t);var a=t.data.orderId;s.$router.push("/confirmOrder/".concat(a))}else s.$swal("購物車沒有東西")})).catch((function(t){s.$swal("送出失敗")}))}},mounted:function(){this.getCartList()}},c=o,n=(a("c099"),a("2877")),l=Object(n["a"])(c,e,r,!1,null,"074fc3f2",null);s["default"]=l.exports},cb89:function(t,s,a){},e68f:function(t,s,a){"use strict";a("99af"),a("159b");s["a"]={data:function(){return{carts:{},cartSelect:1}},methods:{getCartList:function(){var t="".concat("https://vue-course-api.hexschool.io","/api/").concat("hsinhui","/cart"),s=this;this.$http.get(t).then((function(t){s.carts=t.data.data,localStorage.setItem("cartList",JSON.stringify(s.carts.carts)),s.$bus.$emit("cartPush",s.carts.carts)}))},addToCart:function(t,s){var a="".concat("https://vue-course-api.hexschool.io","/api/").concat("hsinhui","/cart"),e=this,r=e.carts.carts,i=1;r.forEach((function(a){if(t==a.product_id){i=a.qty+s;var r=a.id,o="".concat("https://vue-course-api.hexschool.io","/api/").concat("hsinhui","/cart/").concat(r);e.$http.delete(o).then((function(t){}))}})),e.isLoading=!0;var o={product_id:t,qty:i};this.$http.post(a,{data:o}).then((function(t){e.$swal("加入購物車成功!"),e.$bus.$emit("cartPush",e.carts.carts),e.getCartList(),e.isLoading=!1}))},showAlert:function(t){var s=this;s.$swal({title:"確定要從購物車移除此商品?",showCancelButton:!0,cancelButtonText:"取消",confirmButtonText:"確定"}).then((function(a){a.isConfirmed&&(s.$swal("刪除成功","","success"),s.deleteCart(t))}))},deleteCart:function(t){var s=this,a="".concat("https://vue-course-api.hexschool.io","/api/").concat("hsinhui","/cart/").concat(t);this.$http.delete(a).then((function(t){console.log(t),s.getCartList()})).catch((function(t){console.log(t)}))}}}}}]);
//# sourceMappingURL=chunk-5af41066.4cbefdde.js.map